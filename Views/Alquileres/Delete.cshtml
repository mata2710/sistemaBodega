@model SistemaBodega.Models.Alquiler
@using Microsoft.AspNetCore.Http

@{
    ViewData["Title"] = "Eliminar alquiler";
    var rol = Context?.Session?.GetString("Rol");
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />

<style>
    /* ===== Estructura general ===== */
    .section-title {
        font-size: 1rem;
        font-weight: 600;
        margin-bottom: .75rem;
        padding-left: .65rem;
        border-left: 4px solid #00809D;
    }

    .card.shadow-sm {
        border: 1px solid rgba(0,0,0,.06);
    }

    .page-tools {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: .75rem;
    }

        .page-tools .btn {
            margin-top: 0 !important;
        }

    /* Aviso suave de peligro (MISMA CLASE que clientes) */
    .alert-danger-soft {
        background: #fdecea;
        color: #b42318;
        border: 1px solid #f5c2c7;
        border-radius: .5rem;
        padding: .75rem 1rem;
    }

    /* Grid para listas */
    .dl-grid {
        display: grid;
        grid-template-columns: 180px 1fr;
        row-gap: .35rem;
        column-gap: 1rem;
    }

        .dl-grid dt {
            color: #6c757d;
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .dl-grid dd {
            margin: 0;
        }

    @@media (max-width:768px) {
        .dl-grid {
            grid-template-columns: 1fr;
        }
    }

    /* Badge "Pendiente" (igual que clientes, por si hay valores vacíos) */
    .badge-pending {
        background: #EAC8A6;
        color: #3d2b12;
        border: 1px solid #EAC8A6;
        padding: .2rem .55rem;
        border-radius: 999px;
        font-weight: 600;
        font-size: .85rem;
    }

    /* Link utilitario (mismo estilo base) */
    .link-accent {
        color: #00809D;
        text-decoration: none;
    }

        .link-accent:hover {
            color: #00748A;
            text-decoration: underline;
        }
</style>

<div class="page-tools mt-3 mb-3">
    <h2 class="mb-0 text-danger">
        <i class="bi bi-exclamation-triangle me-1"></i> Eliminar alquiler
    </h2>
    <a asp-action="Index" class="btn btn-sm btn-outline-secondary">
        <i class="bi bi-arrow-left-short"></i> Volver al listado
    </a>
</div>

<!-- MISMA alerta que clientes -->
<div class="alert-danger-soft mb-3">
    <strong>Acción permanente:</strong> esta operación eliminará el registro del alquiler.
</div>

<div class="row g-3">
    <!-- Columna principal: Resumen -->
    <div class="col-lg-8">
        <div class="card shadow-sm">
            <div class="card-body">
                <div class="section-title">Resumen</div>
                <dl class="dl-grid">
                    <dt><i class="bi bi-person me-2"></i>Cliente</dt>
                    <dd>@(string.IsNullOrWhiteSpace(Model?.Cliente?.Nombre) ? Html.Raw("<span class='badge-pending'>Pendiente</span>") : Html.Raw(Model.Cliente!.Nombre))</dd>

                    <dt><i class="bi bi-house-door me-2"></i>Bodega</dt>
                    <dd>@(string.IsNullOrWhiteSpace(Model?.Bodega?.Nombre) ? Html.Raw("<span class='badge-pending'>Pendiente</span>") : Html.Raw(Model.Bodega!.Nombre))</dd>

                    <dt><i class="bi bi-calendar-event me-2"></i>Fecha de inicio</dt>
                    <dd>@Model.FechaInicio.ToString("yyyy-MM-dd")</dd>

                    <dt><i class="bi bi-calendar2-check me-2"></i>Fecha de fin</dt>
                    <dd>@(Model.FechaFin == default(DateTime) ? Html.Raw("<span class='badge-pending'>Pendiente</span>") : Html.Raw(Model.FechaFin.ToString("yyyy-MM-dd")))</dd>

                    <dt><i class="bi bi-repeat me-2"></i>Renovación automática</dt>
                    <dd>@(Model.RenovacionAutomatica ? "Sí" : "No")</dd>

                    <dt><i class="bi bi-circle-fill me-2"></i>Activo</dt>
                    <dd>@(Model.Activo ? "Activo" : "Inactivo")</dd>
                </dl>
            </div>
        </div>
    </div>

    <!-- Columna lateral: Económicos / Contrato -->
    <div class="col-lg-4">
        <div class="card shadow-sm">
            <div class="card-body">
                <div class="section-title">Económicos</div>
                <dl class="dl-grid">
                    <dt><i class="bi bi-aspect-ratio me-2"></i>Área (m²)</dt>
                    <dd>@((Model.AreaM2 ?? 0m).ToString("N2"))</dd>

                    <dt><i class="bi bi-currency-dollar me-2"></i>Precio por m²</dt>
                    <dd>$ @((Model.PrecioPorM2 ?? 0m).ToString("N2"))</dd>

                    <dt><i class="bi bi-cash-stack me-2"></i>Precio de alquiler</dt>
                    <dd>$ @((Model.PrecioAlquiler ?? 0m).ToString("N2"))</dd>

                    <dt><i class="bi bi-graph-up me-2"></i>Aumento anual</dt>
                    <dd>@((Model.AumentoAnualPorcentaje ?? 0m).ToString("0.##")) %</dd>
                </dl>
            </div>
        </div>

        <div class="card shadow-sm mt-3">
            <div class="card-body">
                <div class="section-title">Contrato</div>
                @if (!string.IsNullOrWhiteSpace(Model?.ContratoFilePath))
                {
                    <div class="d-grid gap-2">
                        <a href="@Model.ContratoFilePath" target="_blank" rel="noopener" class="link-accent">
                            <i class="bi bi-file-earmark-text me-1"></i> Ver contrato
                        </a>
                        <a href="@Model.ContratoFilePath" download class="link-accent">
                            <i class="bi bi-download me-1"></i> Descargar
                        </a>
                    </div>
                }
                else
                {
                    <span class="badge-pending">Pendiente</span>
                }
            </div>
        </div>
    </div>
</div>

<form asp-action="Delete" method="post" class="mt-3">
    @Html.AntiForgeryToken()
    <input type="hidden" asp-for="Id" />
    <button type="submit" class="btn btn-danger">
        <i class="bi bi-trash3"></i> Eliminar
    </button>
    <a asp-action="Index" class="btn btn-secondary ms-2">
        <i class="bi bi-x-circle"></i> Cancelar
    </a>
</form>

