@{
    ViewData["Title"] = "Iniciar sesión";
}

<div class="login-wrap bg-white">
    <div class="accent-bar"></div>

    <div class="container d-flex align-items-center justify-content-center min-vh-100">
        <div class="login-card card shadow-lg border-0 rounded-4">
            <div class="card-body p-4 p-md-5">

                <div class="text-center mb-4">
                    <div class="photo-frame mx-auto mb-3">
                        <span class="fw-bold">SB</span>
                    </div>
                    <h1 class="h3 fw-bold mb-1">Industrias Unidas S.A</h1>
                    <p class="text-muted mb-0">Accede a tu cuenta</p>
                </div>

                @if (TempData["Mensaje"] != null)
                {
                    <div class="alert alert-success text-center rounded-3">@TempData["Mensaje"]</div>
                }

                <form asp-action="Login" method="post" novalidate>
                    @Html.AntiForgeryToken()

                    <div class="mb-3">
                        <label for="correo" class="form-label fw-semibold">Correo electrónico</label>
                        <input id="correo" type="email" name="correo" class="form-control form-control-lg" placeholder="tu@correo.com" required />
                        <div class="form-text">Usa el correo registrado en el sistema.</div>
                    </div>

                    <div class="mb-2">
                        <label for="contrasena" class="form-label fw-semibold">Contraseña</label>

                        <!-- 🔧 Wrapper solo para input + botón -->
                        <div class="has-toggle">
                            <input id="contrasena" type="password" name="contrasena"
                                   class="form-control form-control-lg" placeholder="••••••••" required />

                            <button type="button"
                                    class="toggle-pass"
                                    aria-label="Mostrar u ocultar contraseña"
                                    aria-pressed="false"
                                    data-target="#contrasena">
                                <i class="fa-solid fa-eye-slash"></i>
                            </button>
                        </div>
                    </div>

                    <div class="d-grid gap-2 mt-4">
                        <button type="submit" class="btn-ingresar">Ingresar</button>
                    </div>

                    <div class="text-center mt-3">
                        <a class="link-accent" asp-controller="Cuenta" asp-action="Recuperar">
                            ¿Olvidaste tu contraseña? Recupérala aquí
                        </a>
                    </div>
                </form>

                @if (ViewBag.Error != null)
                {
                    <div class="alert alert-danger mt-3 text-center rounded-3">@ViewBag.Error</div>
                }

                <hr class="my-4" />

                <p class="text-center mb-0">
                    ¿No tienes cuenta?
                    <a class="link-accent fw-semibold" asp-controller="Cuenta" asp-action="Register">Regístrate aquí</a>
                </p>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        (function () {
            const btn = document.querySelector('.toggle-pass');
            const input = document.getElementById('contrasena');
            if (!btn || !input) return;

            const icon = btn.querySelector('i');

            btn.addEventListener('click', function () {
                const isHidden = input.type === 'password';
                input.type = isHidden ? 'text' : 'password';

                if (isHidden) {
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                    btn.setAttribute('aria-label', 'Ocultar contraseña');
                    btn.setAttribute('aria-pressed', 'true');
                } else {
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                    btn.setAttribute('aria-label', 'Mostrar contraseña');
                    btn.setAttribute('aria-pressed', 'false');
                }
                input.focus();
            });
        })();
    </script>
}
